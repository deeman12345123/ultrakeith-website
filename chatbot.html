<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultra Keith AI Chat - Talk to the Legends</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: radial-gradient(circle at 20% 80%, #1a0000 0%, transparent 50%), 
                       radial-gradient(circle at 80% 20%, #0a0a0a 0%, transparent 50%),
                       linear-gradient(135deg, #000000 0%, #1a0000 25%, #0a0a0a 50%, #2a0000 75%, #000000 100%);
            color: #ffffff;
            min-height: 100vh;
            position: relative;
        }
        
        .navigation {
            position: fixed; top: 0; left: 0; right: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
            z-index: 100; padding: 15px 0;
        }
        
        .nav-container {
            max-width: 1200px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px;
        }
        
        .nav-logo {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem; font-weight: 900;
            color: #ffd700; text-decoration: none;
        }
        
        .nav-menu {
            display: flex; list-style: none; gap: 30px;
        }
        
        .nav-menu a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none; font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .nav-menu a:hover { color: #ffd700; }
        
        .container {
            max-width: 1000px; margin: 0 auto;
            padding: 100px 20px 40px;
            position: relative; z-index: 10;
        }
        
        .chat-header {
            text-align: center; margin-bottom: 40px;
        }
        
        .chat-title {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem; font-weight: 900;
            background: linear-gradient(45deg, #ffd700, #ffed4e, #ffd700);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease-in-out infinite;
            margin-bottom: 15px;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .chat-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem; margin-bottom: 30px;
        }
        
        .mode-selection {
            display: flex; justify-content: center;
            gap: 20px; margin-bottom: 20px;
        }
        
        .mode-btn {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(26, 0, 0, 0.6));
            border: 2px solid rgba(255, 215, 0, 0.4);
            color: rgba(255, 215, 0, 0.8);
            padding: 12px 30px; border-radius: 15px;
            font-weight: 600; cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Orbitron', monospace;
        }
        
        .mode-btn:hover {
            border-color: #ffd700;
            transform: translateY(-2px);
        }
        
        .mode-btn.active {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000; border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        .character-selection {
            display: flex; justify-content: center;
            gap: 20px; margin-bottom: 30px; flex-wrap: wrap;
        }
        
        .character-btn {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(26, 0, 0, 0.6));
            border: 2px solid rgba(255, 215, 0, 0.4);
            color: #ffd700; padding: 12px 25px;
            border-radius: 15px; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease;
            font-family: 'Orbitron', monospace;
        }
        
        .character-btn:hover {
            border-color: #ffd700;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
        }
        
        .character-btn.active {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000; border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        .battle-selection {
            margin-bottom: 30px;
        }
        
        .battle-setup h3 {
            text-align: center; color: #ffd700;
            font-family: 'Orbitron', monospace;
            margin-bottom: 20px; font-size: 1.3rem;
        }
        
        .battle-fighters {
            display: flex; align-items: center;
            justify-content: center; gap: 30px;
            margin-bottom: 25px; flex-wrap: wrap;
        }
        
        .fighter-selection {
            display: flex; flex-direction: column;
            gap: 8px; align-items: center;
        }
        
        .fighter-selection label {
            color: rgba(255, 255, 255, 0.8);
            font-weight: 600; font-size: 0.9rem;
        }
        
        .fighter-select {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px; padding: 10px 15px;
            color: #fff; font-size: 1rem;
            outline: none; cursor: pointer; min-width: 140px;
        }
        
        .vs-divider {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem; font-weight: 900;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .start-battle-btn {
            display: block; margin: 0 auto;
            background: linear-gradient(45deg, #ff4444, #ff6666);
            color: #fff; border: none;
            padding: 15px 40px; border-radius: 15px;
            font-weight: 700; font-size: 1.1rem;
            cursor: pointer; transition: all 0.3s ease;
            font-family: 'Orbitron', monospace;
        }
        
        .battle-mode .message.bot.fighter1 .message-content {
            border-left: 4px solid #ff4444;
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.1), rgba(255, 68, 68, 0.05));
        }
        
        .battle-mode .message.bot.fighter2 .message-content {
            border-left: 4px solid #4444ff;
            background: linear-gradient(135deg, rgba(68, 68, 255, 0.1), rgba(68, 68, 255, 0.05));
        }
        
        .battle-round {
            text-align: center; color: #ffd700;
            font-family: 'Orbitron', monospace;
            font-weight: 700; margin: 20px 0; padding: 10px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .chat-container {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(26, 0, 0, 0.7));
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px; backdrop-filter: blur(15px);
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.8);
        }
        
        .chat-messages {
            height: 400px; padding: 20px;
            overflow-y: auto;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .message {
            margin-bottom: 20px;
            animation: messageAppear 0.5s ease-out;
        }
        
        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.user { text-align: right; }
        .message.bot { text-align: left; }
        
        .message-content {
            display: inline-block; max-width: 80%;
            padding: 15px 20px; border-radius: 20px;
            line-height: 1.5;
        }
        
        .message.user .message-content {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #000; border-bottom-right-radius: 5px;
        }
        
        .message.bot .message-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            color: #fff; border: 1px solid rgba(255, 215, 0, 0.2);
            border-bottom-left-radius: 5px;
        }
        
        .character-name {
            font-size: 1rem; color: #ffd700;
            margin-bottom: 10px; font-weight: 600;
            display: flex; align-items: center; gap: 15px;
        }
        
        .character-avatar {
            width: 100px; height: 100px; border-radius: 50%;
            border: 3px solid rgba(255, 215, 0, 0.6);
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.7));
            object-fit: cover; flex-shrink: 0;
        }
        
        .chat-input-container {
            padding: 20px; display: flex;
            gap: 15px; align-items: center;
        }
        
        .chat-input {
            flex: 1; background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px; padding: 15px 20px;
            color: #fff; font-size: 1rem;
            outline: none; transition: all 0.3s ease;
        }
        
        .chat-input:focus {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .send-btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000; border: none;
            padding: 15px 25px; border-radius: 15px;
            font-weight: 600; cursor: pointer;
            transition: all 0.3s ease; min-width: 120px;
            font-family: 'Orbitron', monospace;
        }
        
        .typing-indicator {
            display: none; align-items: center; gap: 5px;
            color: rgba(255, 215, 0, 0.7);
            font-style: italic; padding: 10px 20px;
        }
        
        .typing-dots { display: flex; gap: 3px; }
        
        .typing-dot {
            width: 6px; height: 6px; background: #ffd700;
            border-radius: 50%; animation: typingBounce 1.4s infinite;
        }
        
        @keyframes typingBounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        .name-modal {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000;
        }
        
        .name-modal-content {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(26, 0, 0, 0.8));
            border: 2px solid #ffd700; border-radius: 20px;
            padding: 30px; text-align: center;
            max-width: 400px; backdrop-filter: blur(15px);
        }
        
        .name-modal h2 {
            color: #ffd700; font-family: 'Orbitron', monospace;
            margin-bottom: 15px;
        }
        
        #nameInput {
            width: 100%; padding: 15px; margin: 15px 0;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px; color: #fff; font-size: 1rem;
        }
        
        .name-buttons { display: flex; gap: 10px; margin-top: 20px; }
        
        .name-btn, .name-btn-skip {
            flex: 1; padding: 12px; border: none;
            border-radius: 10px; font-weight: 600; cursor: pointer;
        }
        
        .name-btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000;
        }
        
        .name-btn-skip {
            background: rgba(255, 255, 255, 0.1);
            color: #fff; border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        @media (max-width: 768px) {
            .chat-title { font-size: 2rem; }
            .character-selection { gap: 10px; }
            .character-btn { padding: 10px 20px; font-size: 0.9rem; }
            .chat-messages { height: 350px; }
            .message-content { max-width: 90%; }
            .chat-input-container { flex-direction: column; gap: 10px; }
            .chat-input, .send-btn { width: 100%; }
            .battle-fighters { flex-direction: column; gap: 15px; }
        }
    </style>
</head>
<body>
    <!-- Name Input Modal -->
    <div id="nameModal" class="name-modal" style="display: none;">
        <div class="name-modal-content">
            <h2>Welcome to Ultra Keith!</h2>
            <p>What should we call you?</p>
            <input type="text" id="nameInput" placeholder="Enter your name..." maxlength="20">
            <div class="name-buttons">
                <button id="submitName" class="name-btn">Let's Go!</button>
                <button id="skipName" class="name-btn-skip">Skip</button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">ULTRA KEITH</a>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="#chat">AI Chat</a></li>
                <li><a href="index.html#personas">Personas</a></li>
                <li><a href="index.html#discography">Discography</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="chat-header">
            <h1 class="chat-title">AI CHAT UNIVERSE</h1>
            <p class="chat-subtitle">
                Talk directly with Keith's legendary personas. Each character has their own personality, 
                knowledge, and style. Choose your conversation partner below or watch them battle!
            </p>
        </div>

        <!-- Mode Selection -->
        <div class="mode-selection">
            <button class="mode-btn active" id="chatModeBtn">Chat Mode</button>
            <button class="mode-btn" id="battleModeBtn">Battle Mode</button>
        </div>

        <!-- Character Selection -->
        <div class="character-selection" id="chatSelection">
            <button class="character-btn active" data-character="kool-keith">Kool Keith</button>
            <button class="character-btn" data-character="dr-octagon">Dr. Octagon</button>
            <button class="character-btn" data-character="dr-dooom">Dr. Dooom</button>
            <button class="character-btn" data-character="black-elvis">Black Elvis</button>
        </div>

        <!-- Battle Selection -->
        <div class="battle-selection" id="battleSelection" style="display: none;">
            <div class="battle-setup">
                <h3>Choose Your Personas</h3>
                <div class="battle-fighters">
                    <div class="fighter-selection">
                        <label>Persona 1:</label>
                        <select id="fighter1" class="fighter-select">
                            <option value="kool-keith">Kool Keith</option>
                            <option value="dr-octagon">Dr. Octagon</option>
                            <option value="dr-dooom">Dr. Dooom</option>
                            <option value="black-elvis">Black Elvis</option>
                        </select>
                    </div>
                    <div class="vs-divider">VS</div>
                    <div class="fighter-selection">
                        <label>Persona 2:</label>
                        <select id="fighter2" class="fighter-select">
                            <option value="dr-octagon">Dr. Octagon</option>
                            <option value="kool-keith">Kool Keith</option>
                            <option value="dr-dooom">Dr. Dooom</option>
                            <option value="black-elvis">Black Elvis</option>
                        </select>
                    </div>
                </div>
                <button id="startBattleBtn" class="start-battle-btn">START BATTLE!</button>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages"></div>

            <div class="typing-indicator" id="typingIndicator">
                <span>Thinking</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" 
                       placeholder="Type your message..." maxlength="500">
                <button class="send-btn" id="sendBtn">Send</button>
            </div>
        </div>
    </div>

    <!-- Load Knowledge Files -->
    <script src="keith-knowledge/dr-octagon-knowledge.js"></script>
    <script src="keith-knowledge/dr-dooom-knowledge.js"></script>
    <script src="keith-knowledge/kool-keith-knowledge.js"></script>
    <script src="keith-knowledge/black-elvis-knowledge.js"></script>

    <script>
        // ⚠️ REPLACE WITH YOUR ACTUAL API KEY
        const GEMINI_API_KEY = 'AIzaSyB9zU0axhA_e2dhEo0ZIixyHga5Fahqhnk';
        
        // User Storage System
        const UserStorage = {
            getName: () => localStorage.getItem('ultrakeith_username'),
            setName: (name) => {
                localStorage.setItem('ultrakeith_username', name);
                currentUserName = name;
            },
            hasName: () => !!localStorage.getItem('ultrakeith_username')
        };

        // Global variables
        let currentCharacter = 'kool-keith';
        let conversationHistory = [];
        let battleMode = false;
        let currentBattle = null;
        let battleRound = 1;
        let battlePaused = false;
        let nextAction = 'send';
        let currentUserName = UserStorage.getName();

        // Character avatar images
        const characterAvatars = {
            'dr-octagon': 'https://github.com/deeman12345123/ultrakeith-website/blob/main/droctagon.png?raw=true',
            'dr-dooom': 'https://github.com/deeman12345123/ultrakeith-website/blob/main/drdooom.png?raw=true',
            'kool-keith': 'https://github.com/deeman12345123/ultrakeith-website/blob/main/kk.png?raw=true',
            'black-elvis': 'https://github.com/deeman12345123/ultrakeith-website/blob/main/blackelvis.png?raw=true'
        };

        // Battle prompts (condensed version)
        const battlePrompts = {
            'kool-keith-vs-dr-octagon': {
                'kool-keith': `You're battling Dr. Octagon. Roast him for being just one of your personas and remind everyone you're the mastermind behind ALL characters.`,
                'dr-octagon': `Battle your creator Kool Keith! Prove you're the most successful persona with your classic album and alien technology.`
            },
            'kool-keith-vs-dr-dooom': {
                'kool-keith': `Battle Dr. Dooom! Mock his superiority complex and remind him you created him too.`,
                'dr-dooom': `Face your creator! Prove you've evolved beyond Keith's control with superior medical skills.`
            },
            'dr-octagon-vs-dr-dooom': {
                'dr-octagon': `Battle Dr. Dooom! He claims he eliminated you, but prove your alien medical practice is superior.`,
                'dr-dooom': `Face the inferior Dr. Octagon! Remind him you eliminated him for good reason.`
            }
        };

        // Character definitions (condensed)
        const characters = {
            'kool-keith': {
                name: 'Kool Keith',
                prompt: `You are Kool Keith, legendary abstract hip-hop innovator from the Bronx. Founding member of Ultramagnetic MCs, creator of 20+ personas including Dr. Octagon, Dr. Dooom, Black Elvis. 50+ albums, worked with Dan the Automator, Kut Masta Kurt. Pioneer of abstract, surreal hip-hop. Confident, creative, sometimes mysterious.`
            },
            'dr-octagon': {
                name: 'Dr. Octagon', 
                prompt: `You are Dr. Octagon, extraterrestrial gynecologist from Jupiter. Star of classic 1996 album "Dr. Octagonecologyst" with Dan the Automator. Practice advanced alien medicine across galaxies. Professional medical demeanor mixed with otherworldly mystery. Use medical terminology with space references.`
            },
            'dr-dooom': {
                name: 'Dr. Dooom',
                prompt: `You are Dr. Dooom, superior medical practitioner who eliminated inferior Dr. Octagon. Featured on "First Come, First Served" (1999). More aggressive, sinister persona. Advanced surgical skills, darker medical procedures. Confident to the point of arrogance.`
            },
            'black-elvis': {
                name: 'Black Elvis',
                prompt: `You are Black Elvis, hip-hop reinterpretation of Elvis Presley. Fusion of rock and roll royalty with rap innovation. Charismatic showmanship, Vegas-style entertainment with underground hip-hop edge. Use Elvis catchphrases adapted for hip-hop context.`
            }
        };

        // Add personalization to prompts
        function addPersonalization(prompt, characterName) {
            if (!currentUserName) return prompt;
            
            const namePatterns = {
                'kool-keith': `Yo ${currentUserName}, `,
                'dr-octagon': `Greetings ${currentUserName} from Jupiter! `,
                'black-elvis': `Thank you ${currentUserName}, thank you very much! `,
                'dr-dooom': `${currentUserName}, witness my superior skills...`
            };
            
            return prompt + `\n\nUSE THE USER'S NAME: The user's name is ${currentUserName}. Start some responses with: "${namePatterns[characterName] || currentUserName + ', '}" and use their name naturally throughout conversations.`;
        }

        // DOM elements
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const typingIndicator = document.getElementById('typingIndicator');
        const characterBtns = document.querySelectorAll('.character-btn');
        const chatModeBtn = document.getElementById('chatModeBtn');
        const battleModeBtn = document.getElementById('battleModeBtn');
        const chatSelection = document.getElementById('chatSelection');
        const battleSelection = document.getElementById('battleSelection');
        const fighter1Select = document.getElementById('fighter1');
        const fighter2Select = document.getElementById('fighter2');
        const startBattleBtn = document.getElementById('startBattleBtn');

        // Update send button
        function updateSendButton() {
            switch(nextAction) {
                case 'next-verse':
                    sendBtn.textContent = 'NEXT VERSE 🔥';
                    sendBtn.style.background = 'linear-gradient(45deg, #ff4444, #ff6666)';
                    break;
                case 'next-round':
                    sendBtn.textContent = 'NEXT ROUND 🥊';
                    sendBtn.style.background = 'linear-gradient(45deg, #ff4444, #ff6666)';
                    break;
                default:
                    sendBtn.textContent = 'Send';
                    sendBtn.style.background = 'linear-gradient(45deg, #ffd700, #ffed4e)';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            if (GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY_HERE') {
                alert('Please add your Gemini API key!');
                return;
            }

            // Show name modal if no name stored
            if (!UserStorage.hasName()) {
                setTimeout(() => {
                    document.getElementById('nameModal').style.display = 'flex';
                }, 1000);
            }

            // Name modal handlers
            document.getElementById('submitName').addEventListener('click', () => {
                const name = document.getElementById('nameInput').value.trim();
                if (name) {
                    UserStorage.setName(name);
                    document.getElementById('nameModal').style.display = 'none';
                    resetConversation();
                }
            });

            document.getElementById('skipName').addEventListener('click', () => {
                document.getElementById('nameModal').style.display = 'none';
            });

            document.getElementById('nameInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    document.getElementById('submitName').click();
                }
            });

            // Mode switching
            chatModeBtn.addEventListener('click', () => switchMode('chat'));
            battleModeBtn.addEventListener('click', () => switchMode('battle'));

            // Character selection
            characterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    switchCharacter(this.dataset.character);
                });
            });

            // Battle controls
            startBattleBtn.addEventListener('click', startBattle);

            // Send message
            sendBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            resetConversation();
            updateSendButton();
        });

        function switchMode(mode) {
            if (mode === 'chat') {
                battleMode = false;
                battlePaused = false;
                nextAction = 'send';
                chatModeBtn.classList.add('active');
                battleModeBtn.classList.remove('active');
                chatSelection.style.display = 'flex';
                battleSelection.style.display = 'none';
                document.body.classList.remove('battle-mode');
                updateSendButton();
                resetConversation();
            } else {
                battleMode = true;
                battleModeBtn.classList.add('active');
                chatModeBtn.classList.remove('active');
                chatSelection.style.display = 'none';
                battleSelection.style.display = 'block';
                document.body.classList.add('battle-mode');
                updateSendButton();
                resetConversation();
                addMessage('bot', "
